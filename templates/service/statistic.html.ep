% layout 'default';
% use Rplus::Model::MediaImportStatistic::Manager;
% use Rplus::Model::MediaImportError::Manager;
% use Rplus::Model::RealtyType::Manager;
% use DBM::Deep;
% my $db = DBM::Deep->new( "zavrus.deep.db" );
<head>
  <style type="text/css">
    td {
      font-size: 14pt;
      border: 1px solid rgba(119, 119, 119, 0.17);
    }
    table{
        margin: 10px 5px 0;
    }

    tbody td {
      color: rgba(8, 8, 8, 0.7);
    }

    </style>
</head>
<div>
    <table>
        <thead style="background: #062141; color: #ffffff;", align='center', height="50">
            <tr >
                <td width="60px">№</td>
                <td width="150px">IP-адрес</td>
                <td width="200px">Дата/время</td>
                <td width="75px">Тип <br>аренды</td>
                <td width="200">Тип недвижимости</td>
                <td width="350">Район</td>
                <td width="70px">Комнат</td>
                <td width="115px">Цена</td>
                <td style="width: calc(100vw - 1220px);">Поиск</td>
            </tr>
        </thead>
        <tbody align='center'>
            % my $i=scalar @{$db->{queres}};
            % foreach (reverse @{$db->{queres}}){
            <tr>
            %  my @y = @{Rplus::Model::RealtyType::Manager->get_objects(select => 'name', query => [code => $_->{type_code}])};
                <td><%= $i %></td>
                <td><%= $_->{ip} %></td>
                <td><%= $_->{date} %></td>
                <td><%= $_->{offer_type} %></td>
                <td><%= $y[0]->{name} %></td>
                <td><%= $_->{district} %></td>
                <td><%= $_->{rooms_count} %></td>
                <td><%= $_->{price} %></td>
                <td><%= $_->{query} %></td>
            </tr>
            % $i--;}
        </tbody>
    </table>
</div>
